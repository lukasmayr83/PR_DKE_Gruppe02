{% extends "base.html" %}
{% block title %}Aktion bearbeiten{% endblock %}

{% block content %}
  <h1>Aktion bearbeiten</h1>

  {% if is_running %}
    <p style="margin: 12px 0; padding: 10px; border: 1px solid #f0ad4e;">
      Diese Aktion ist aktuell <strong>aktiv</strong>. Sie kann nicht mehr bearbeitet werden – nur beendet.
    </p>
  {% endif %}

  <form method="post">
    {{ form.hidden_tag() }}

    <div class="field-row">
      <div>
        <label>Name</label>
        {{ form.name(disabled=is_running) }}
      </div>
      <div>
        <label>Wert %</label>
        {{ form.rabattWert(disabled=is_running) }}
      </div>
    </div>

    <div class="field-row">
      <div>
        <label>Beschreibung</label>
        {{ form.beschreibung(disabled=is_running) }}
      </div>
    </div>

    <div class="field-row">
      <div>
        <label>Startdatum</label>
        {{ form.startZeit(disabled=is_running) }}
      </div>
      <div>
        <label>Enddatum</label>
        {{ form.endeZeit(disabled=is_running) }}
      </div>
    </div>

    <div class="field-row">
      <div>
        <label>Typ</label>
        <input type="text" value="{{ 'GLOBAL' if aktion.typ == 'global' else 'HALTEPLAN' }}" readonly>
      </div>

      {% if aktion.typ == 'halteplan' %}
        <div>
          <label>Halteplan</label>
          {{ form.halteplanId(disabled=is_running) }}
        </div>
      {% endif %}
    </div>

    <div class="field-row">
      <div>
        {{ form.aktiv(disabled=is_running) }}
        {{ form.aktiv.label }}
      </div>
    </div>

    {% if not is_running %}
      <button class="btn" type="submit">Änderungen übernehmen</button>
    {% endif %}
  </form>

  {% if is_running %}
    <form method="post" action="{{ url_for('main.aktion_stop', aktion_id=aktion.id) }}" style="margin-top:12px;">
      <button class="btn" type="submit">Aktion beenden</button>
    </form>
  {% endif %}

  <form method="post" action="{{ url_for('main.aktion_delete', aktion_id=aktion.id) }}" style="margin-top:16px;">
    <button class="btn" type="submit">Aktion löschen</button>
  </form>
{% endblock %}
