{% extends "base.html" %}

{% block content %}
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
<script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>

<style>

    body { background-color: #f8f9fa; }

    .flex-container {
    display: flex;
    /* "flex-start" ist der Standard-Befehl für Linksbündig in Flexbox */
    justify-content: flex-start;

    margin: 20px;

    /* Optional: Damit das Padding nicht die Breite vergrößert */
    box-sizing: border-box;
    width: 100%;
}

    /* Formular-Bereich */
    .form-wrapper {
        width: 100%; max-width: 600px; min-width: 300px;
        padding: 25px; background-color: #ffffff;
        border-radius: 10px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
    }

    /*Abstand links von der Überschrift*/
    h1 {
        margin-left: 25px;
    }

    /* Abstände der Formulargruppen */
    .form-wrapper p {
        margin-bottom: 25px;
    }

    /* Beschriftung der Felder*/
    .form-wrapper label {
        display: block;
        margin-bottom: 5px;
        font-weight: 600;
        color: #343a40;
        font-size: 20px;
    }
    /*Textfelder, Datumsfelder und Textbereiche:   */
    .form-wrapper input[type="text"],
    .form-wrapper input[type="datetime-local"],
    .form-wrapper textarea {
        width: 100%; /*breite 100 Prozent */
        padding: 10px 12px;
        border: 1px solid #ced4da; border-radius: 6px; /*Ecken der Felder abrunden*/
        box-sizing: border-box; /*damit Padding mit einberechnet wird bei der Breite*/
        font-size: 16px;
        font-family: inherit;
    }

    /*wird blau, wenn der user das Feld anklickt*/
    .form-wrapper input:focus, .form-wrapper textarea:focus {
        border-color: #007bff;
        outline: none;
        box-shadow: 0 0 0 3px rgba(0, 123, 255, 0.25);
    }

    .form-wrapper textarea { min-height: 100px; resize: vertical; } /*Mindesthöhe für Textfeld*/

    .text-danger { color: red; display: block; margin-top: 5px; }

    /* BUTTONS */
    .btn {
        padding: 10px 20px; /*Abstand noch oben/unten und links/rechts*/
        font-size: 16px;  /*Schriftgröße*/
        border-radius: 6px; /*Ecken abrunden*/
        cursor: pointer; /*Hand-symbol*/
    }

    /* Abbrechen-Button anpassen */
    .btn-secondary {
        background-color: #6c757d; /*Hintergrundfarbe*/
        border-color: #6c757d; /*Rahmenfarbe*/
        color: white !important; /*Schriftfarbe*/
        transition: background-color 0.2s; /*Farbübergang*/
    }

 /* Select2  */

    /* äußerer Rahmen */
    .select2-container .select2-selection--multiple {
        border: 1px solid #ced4da !important;
        border-radius: 6px !important;
        min-height: 45px !important;
        padding: 5px !important;
        background-color: #fff;
    }

    /* Elemente  */
    .select2-container .select2-selection--multiple .select2-selection__rendered {
        display: flex !important;
        flex-wrap: wrap !important; /*ausgewählten Elemente in nächste Zeile*/
        align-items: center !important;
        align-content: flex-start !important; /*Tags alle oben bündig*/
        margin: 0 !important;
        padding: 0 !important;
        width: 100% !important;
        box-sizing: border-box !important;
    }

    /* Fokus-Effekt für den Rahmen */
    .select2-container--default.select2-container--focus .select2-selection--multiple {
        border-color: #007bff !important;
        box-shadow: 0 0 0 3px rgba(0, 123, 255, 0.25) !important;
    }

    /* Auswahloptionen */
    .select2-container--default .select2-selection--multiple .select2-selection__choice {
        background-color: #e9ecef !important;
        border: 1px solid #ced4da !important;
        color: #333 !important;
        border-radius: 4px !important;
        margin-top: 2px !important;
        margin-bottom: 2px !important;
        margin-right: 6px !important;
        padding: 4px 8px !important;
    }



</style>

<h1>Warnung hinzufügen</h1>

<div class="flex-container">

    <div class="form-wrapper">
        <form method="POST">
            {{ form.hidden_tag() }}

            <p>
                {{ form.bezeichnung.label }}<br>
                {{ form.bezeichnung() }}
                {% for error in form.bezeichnung.errors %}
                <span class="text-danger">[{{ error }}]</span>
                {% endfor %}
            </p>

            <p>
                {{ form.beschreibung.label }}<br>
                {{ form.beschreibung() }}
                {% for error in form.beschreibung.errors %}
                <span class="text-danger">[{{ error }}]</span>
                {% endfor %}
            </p>

            <p>
                {{ form.startZeit.label }}<br>
                {{ form.startZeit() }}
                {% for error in form.startZeit.errors %}
                <span class="text-danger">[{{ error }}]</span>
                {% endfor %}
            </p>

            <p>
                {{ form.endZeit.label }}<br>
                {{ form.endZeit() }}
                {% for error in form.endZeit.errors %}
                <span class="text-danger">[{{ error }}]</span>
                {% endfor %}
            </p>

            <p>
                {{ form.abschnitt.label }}<br>
                {{ form.abschnitt(id="abschnitte_select", multiple="multiple", style="width: 100%;") }}
                {% for error in form.abschnitt.errors %}
                <span class="text-danger">[{{ error }}]</span>
                {% endfor %}
            </p>

            <p style="margin-top: 40px;">
                {{ form.submit(class="btn btn-primary") }}
                <a href="{{ url_for('warnung') }}" class="btn btn-secondary" style="margin-left: 10px;">Abbrechen</a>
            </p>
        </form>
    </div>

</div>

<script>
    $(document).ready(function() {
        var $select = $('#abschnitte_select');

        // Initialisierung
        $select.select2({
            placeholder: "Bitte Abschnitte wählen...",
            allowClear: true,
            width: '100%'
        });

        // Sortierlogik: Zuletzt gewähltes ans Ende
        $select.on("select2:select", function (evt) {
            var element = evt.params.data.element;
            var $element = $(element);

            $element.detach();
            $(this).append($element);
            $(this).trigger("change");
        });
    });
</script>

{% endblock %}